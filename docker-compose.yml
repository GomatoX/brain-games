services:
  games:
    build:
      context: ./games
      dockerfile: Dockerfile
      args:
        VITE_API_URL: ${VITE_API_URL:-http://localhost:3000}
    ports:
      - "5173:80"
    restart: unless-stopped

  app:
    build:
      context: ./app
      dockerfile: Dockerfile
      args:
        NEXT_PUBLIC_FRONTEND_URL: ${NEXT_PUBLIC_FRONTEND_URL:-http://localhost:5173}
        NEXT_PUBLIC_MODE: ${NEXT_PUBLIC_MODE:-saas}
        NEXT_PUBLIC_PLATFORM_NAME: ${NEXT_PUBLIC_PLATFORM_NAME:-}
        NEXT_PUBLIC_PLATFORM_ACCENT: ${NEXT_PUBLIC_PLATFORM_ACCENT:-}
        NEXT_PUBLIC_PLATFORM_LOGO: ${NEXT_PUBLIC_PLATFORM_LOGO:-}
        NEXT_PUBLIC_HIDE_LANDING: ${NEXT_PUBLIC_HIDE_LANDING:-false}
        NEXT_PUBLIC_HIDE_REGISTER: ${NEXT_PUBLIC_HIDE_REGISTER:-false}
    ports:
      - "3000:3000"
    environment:
      - AUTH_SECRET=${AUTH_SECRET}
      - AUTH_URL=${AUTH_URL:-http://localhost:3000}
      - DATABASE_PATH=/app/data/brain.db
      - GOOGLE_AI_API_KEY=${GOOGLE_AI_API_KEY:-}
    volumes:
      - app_data:/app/data
    restart: unless-stopped

volumes:
  app_data:
